{"version":3,"sources":["webpack:///./node_modules/vue-xlsx/dist/polyfills.js","webpack:///./node_modules/core-js/modules/es.string.trim.js","webpack:///./node_modules/core-js/internals/whitespaces.js","webpack:///./node_modules/core-js/internals/string-trim.js","webpack:///./src/router/views/xlsx.vue?aabe","webpack:///./src/router/views/xlsx.vue?361f","webpack:///./node_modules/core-js/internals/string-trim-forced.js","webpack:///./src/router/views/xlsx.vue?cece","webpack:///./node_modules/vue-xlsx/dist/components/XlsxWorkbook.js","webpack:///./node_modules/vue-xlsx/dist/components/XlsxSheet.js","webpack:///./node_modules/vue-xlsx/dist/components/XlsxDownload.js","webpack:///src/router/views/xlsx.vue","webpack:///./src/router/views/xlsx.vue?ee27","webpack:///./src/router/views/xlsx.vue?794f"],"names":["globalPolyfill","global","window","$","$trim","trim","forcedStringTrimMethod","target","proto","forced","this","module","exports","requireObjectCoercible","whitespaces","whitespace","ltrim","RegExp","rtrim","createMethod","TYPE","$this","string","String","replace","start","end","fails","non","METHOD_NAME","name","render","_vm","_h","$createElement","_c","_self","attrs","_v","class","$style","block","noloThreshold","input","on","highlightPreview","model","value","callback","$$v","expression","_l","sheet","key","data","directives","rawName","xlsxpreview","toggleConcise","warning","domProps","_s","previewHTML","staticRenderFns","WorkbookHandler","libLoaded","loading","getWorkbook","methods","$emit","_callbackQueue","Array","isArray","forEach","cb","_workbook","e","console","push","script","mixins","addSheet","deleteSheet","load","utils","book_new","book_append_sheet","_book_new","_book_append_sheet","sheetName","Sheets","SheetNames","filter","s","undefined","h","$slots","default","normalizeComponent","template","style","scopeId","isFunctionalTemplate","moduleIdentifier","shadowMode","createInjector","createInjectorSSR","createInjectorShadow","hook","options","_compiled","functional","_scopeId","context","$vnode","ssrContext","parent","__VUE_SSR_CONTEXT__","call","_registeredComponents","add","_ssrRegister","$root","$options","shadowRoot","originalRender","existing","beforeCreate","concat","normalizeComponent_1","__vue_script__","__vue_inject_styles__","__vue_scope_id__","__vue_module_identifier__","__vue_is_functional_template__","XlsxWorkbook","typeFinder","Object","collectionValidator","collection","reduce","a","c","inject","props","type","required","length","includes","computed","watch","readyToParse","immediate","parseCollection","aoa_to_sheet","json_to_sheet","_aoa_to_sheet","_json_to_sheet","wb","lib","array","object","_sheet","XlsxSheet","filename","disableWrapperClick","Boolean","loaded","writeFile","_writeFile","$scopedSlots","click","download","XlsxDownload","page","title","meta","components","Layout","waitingForFile","sheets","downloadReady","previewReady","pricesFormatted","mounted","hasWorkbook","processSheet","$router","updated","document","querySelectorAll","v","tc","indexOf","el","textContent","renderPreview","XLSX","sheet_to_html","tr","toggleAttribute","getElementById","injectStyles","locals","component"],"mappings":"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","file":"js/chunk-08f14b58-legacy.1ba2ceaf.js","sourcesContent":["export const globalPolyfill = () => {\n  var global = global || window;\n  if (window) {\n    window.global = global;\n  }\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n","// a string of all valid unicode whitespaces\n// eslint-disable-next-line max-len\nmodule.exports = '\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u00A0\\u1680\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","var requireObjectCoercible = require('../internals/require-object-coercible');\nvar whitespaces = require('../internals/whitespaces');\n\nvar whitespace = '[' + whitespaces + ']';\nvar ltrim = RegExp('^' + whitespace + whitespace + '*');\nvar rtrim = RegExp(whitespace + whitespace + '*$');\n\n// `String.prototype.{ trim, trimStart, trimEnd, trimLeft, trimRight }` methods implementation\nvar createMethod = function (TYPE) {\n  return function ($this) {\n    var string = String(requireObjectCoercible($this));\n    if (TYPE & 1) string = string.replace(ltrim, '');\n    if (TYPE & 2) string = string.replace(rtrim, '');\n    return string;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.{ trimLeft, trimStart }` methods\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trimstart\n  start: createMethod(1),\n  // `String.prototype.{ trimRight, trimEnd }` methods\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trimend\n  end: createMethod(2),\n  // `String.prototype.trim` method\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trim\n  trim: createMethod(3)\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"xlsx_block_AjpBa\",\"noloThreshold\":\"xlsx_noloThreshold_CH9Rm\",\"warning\":\"xlsx_warning_2plv8\",\"xlsxpreview\":\"xlsx_xlsxpreview_2dTVG\"};","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-0-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-0-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./xlsx.vue?vue&type=style&index=0&lang=scss&module=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-0-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-0-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./xlsx.vue?vue&type=style&index=0&lang=scss&module=true&\"","var fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]() || non[METHOD_NAME]() != non || whitespaces[METHOD_NAME].name !== METHOD_NAME;\n  });\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Layout',[_c('h1',[_c('BaseIcon',{attrs:{\"name\":\"file-excel\"}}),_vm._v(\" Compute Estimates\")],1),_c('h2',[_vm._v(\"Preview\")]),_c('div',{class:_vm.$style.block},[_c('span',[_c('label',{attrs:{\"for\":\"noloThreshold\"}},[_vm._v(\"Threshold\")]),_c('BaseInputText',{class:[_vm.$style.noloThreshold, _vm.$style.input],attrs:{\"id\":\"noloThreshold\",\"type\":\"text\",\"pattern\":\"\\\\d{3}\"},on:{\"change\":_vm.highlightPreview},model:{value:(_vm.noloThreshold),callback:function ($$v) {_vm.noloThreshold=$$v},expression:\"noloThreshold\"}})],1),_c('span',[_c('XlsxWorkbook',[_vm._l((_vm.sheets),function(sheet){return _c('XlsxSheet',{key:sheet.name,attrs:{\"collection\":sheet.data,\"sheet-name\":sheet.name}})}),_c('XlsxDownload',{attrs:{\"filename\":\"HEOA-ECOM.xlsx\"}},[_c('BaseButton',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.downloadReady),expression:\"downloadReady\"}],attrs:{\"type\":\"button\"}},[_vm._v(\"Download\")])],1)],2)],1)]),(_vm.previewReady)?_c('div',{class:_vm.$style.xlsxpreview},[_c('p',[_vm._v(\"The preview shows \"),_c('em',{on:{\"click\":_vm.toggleConcise}},[_vm._v(\"all\")]),_vm._v(\" the materials and highlights those less than the threshold. It is intended for a quick check to ensure the spreadsheet data is as expected. \"),_c('strong',{class:_vm.$style.warning},[_vm._v(\"Do not use this for cost estimates.\")])]),_c('table',{attrs:{\"id\":\"previewTable\",\"concise\":\"\"},domProps:{\"innerHTML\":_vm._s(_vm.previewHTML)}})]):_c('div',[_c('p',[_vm._v(\"Please wait ...\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var WorkbookHandler = {\n  data() {\n    return {\n      libLoaded: false,\n      loading: false\n    };\n  },\n  provide() {\n    return {\n      getWorkbook: this.getWorkbook\n    };\n  },\n  methods: {\n    startLoading() {\n      this.loading = true;\n      this.$emit(\"loading\", this.loading);\n    },\n    endLoading() {\n      this.loading = false;\n      this.$emit(\"loading\", this.loading);\n    },\n    fireCallBacks() {\n      if (this._callbackQueue && Array.isArray(this._callbackQueue)) {\n        this._callbackQueue.forEach(cb => {\n          try {\n            cb(this._workbook);\n          } catch (e) {\n            console.warning(\"error in firing callbacks\", e);\n          }\n        });\n      }\n    },\n    getWorkbook(cb) {\n      if (this._callbackQueue) {\n        this._callbackQueue.push(cb);\n      }\n      if (this._workbook) {\n        cb(this._workbook);\n      }\n    }\n  }\n};\n\nvar script = {\n  mixins: [WorkbookHandler],\n  provide() {\n    return {\n      addSheet: this.addSheet,\n      deleteSheet: this.deleteSheet\n    };\n  },\n  mounted() {\n    this.load();\n  },\n  methods: {\n    async load() {\n      const { globalPolyfill } = require(\"../polyfills\");\n      globalPolyfill();\n      const {\n        utils: { book_new, book_append_sheet }\n      } = await import('xlsx');\n      this._book_new = book_new;\n      this._book_append_sheet = book_append_sheet;\n      this._workbook = this._book_new();\n      this.$emit(\"created\", this._workbook);\n      this.libLoaded = true;\n    },\n    addSheet(sheet, sheetName) {\n      if (this._workbook) {\n        this.deleteSheet(sheetName);\n        this._book_append_sheet(this._workbook, sheet, sheetName);\n        this.$emit(\"change\", this._workbook);\n      }\n    },\n    deleteSheet(sheetName) {\n      if (this._workbook && this._workbook.Sheets[sheetName]) {\n        this._workbook.SheetNames = this._workbook.SheetNames.filter(\n          s => s !== sheetName\n        );\n        this._workbook.Sheets[sheetName] = undefined;\n        this.$emit(\"change\", this._workbook);\n      }\n    }\n  },\n  render(h) {\n    if (this.$slots.default && this.libLoaded) {\n      return h(\"div\", this.$slots.default);\n    }\n    return null;\n  }\n};\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nvar normalizeComponent_1 = normalizeComponent;\n\n/* script */\nconst __vue_script__ = script;\n\n/* template */\n\n  /* style */\n  const __vue_inject_styles__ = undefined;\n  /* scoped */\n  const __vue_scope_id__ = undefined;\n  /* module identifier */\n  const __vue_module_identifier__ = undefined;\n  /* functional template */\n  const __vue_is_functional_template__ = undefined;\n  /* style inject */\n  \n  /* style inject SSR */\n  \n\n  \n  var XlsxWorkbook = normalizeComponent_1(\n    {},\n    __vue_inject_styles__,\n    __vue_script__,\n    __vue_scope_id__,\n    __vue_is_functional_template__,\n    __vue_module_identifier__,\n    undefined,\n    undefined\n  );\n\nexport default XlsxWorkbook;\n","const typeFinder = value =>\n  value instanceof Array ? \"array\" : value instanceof Object ? \"object\" : false;\n\nconst collectionValidator = collection => {\n  return collection.reduce((a, c) => {\n    if (a === null) {\n      return typeFinder(c);\n    } else {\n      return typeFinder(c) === a ? a : false;\n    }\n  }, null);\n};\n\nvar script = {\n  inject: [\"getWorkbook\", \"addSheet\", \"deleteSheet\"],\n  props: {\n    sheetName: {\n      type: String,\n      required: true\n    },\n    collection: {\n      type: Array,\n      default: null,\n      validator(value) {\n        if (value && value.length > 0) {\n          const type = collectionValidator(value);\n          return [\"array\", \"object\"].includes(type);\n        }\n        return true;\n      }\n    }\n  },\n  data() {\n    return {\n      libLoaded: false\n    };\n  },\n  computed: {\n    readyToParse() {\n      return this.libLoaded ? this.collection : null;\n    }\n  },\n  watch: {\n    readyToParse: {\n      immediate: true,\n      handler(collection) {\n        if (collection) {\n          this.parseCollection(collection);\n        }\n      }\n    }\n  },\n  mounted() {\n    this.load();\n  },\n  beforeDestroy() {\n    this.deleteSheet(this.sheetName);\n  },\n  methods: {\n    async load() {\n      const {\n        utils: { aoa_to_sheet, json_to_sheet }\n      } = await import('xlsx');\n      this._aoa_to_sheet = aoa_to_sheet;\n      this._json_to_sheet = json_to_sheet;\n      this.libLoaded = true;\n      this.getWorkbook(wb => {\n        this._workbook = wb;\n      });\n    },\n    parseCollection(collection) {\n      const type = typeFinder(collection[0]);\n      const lib = {\n        array: this._aoa_to_sheet,\n        object: this._json_to_sheet\n      };\n      this._sheet = lib[type](collection, this.options);\n      this.$emit(\"parsed\", this._sheet);\n      this.addSheet(this._sheet, this.sheetName);\n    }\n  },\n  render(h) {\n    if (this.$slots.default && this.libLoaded) {\n      return h(\"div\", this.$slots.default);\n    }\n    return null;\n  }\n};\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nvar normalizeComponent_1 = normalizeComponent;\n\n/* script */\nconst __vue_script__ = script;\n\n/* template */\n\n  /* style */\n  const __vue_inject_styles__ = undefined;\n  /* scoped */\n  const __vue_scope_id__ = undefined;\n  /* module identifier */\n  const __vue_module_identifier__ = undefined;\n  /* functional template */\n  const __vue_is_functional_template__ = undefined;\n  /* style inject */\n  \n  /* style inject SSR */\n  \n\n  \n  var XlsxSheet = normalizeComponent_1(\n    {},\n    __vue_inject_styles__,\n    __vue_script__,\n    __vue_scope_id__,\n    __vue_is_functional_template__,\n    __vue_module_identifier__,\n    undefined,\n    undefined\n  );\n\nexport default XlsxSheet;\n","var script = {\n  inject: [\"getWorkbook\"],\n  props: {\n    filename: {\n      type: String,\n      default: \"my-workbook.xlsx\"\n    },\n    options: {\n      type: Object,\n      default: () => ({})\n    },\n    disableWrapperClick: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      loaded: false\n    };\n  },\n  mounted() {\n    this.load();\n  },\n  watch: {\n    loaded: {\n      immediate: true,\n      handler(loaded) {\n        if (loaded) {\n          this.getWorkbook(wb => {\n            this._workbook = wb;\n          });\n        }\n      }\n    }\n  },\n  methods: {\n    async load() {\n      const { writeFile } = await import('xlsx');\n      this._writeFile = writeFile;\n      this.loaded = true;\n    },\n    download() {\n      this._writeFile(this._workbook, this.filename, this.options);\n    }\n  },\n  render(h) {\n    if (this.$scopedSlots.default && this.loaded) {\n      return h(\n        \"div\",\n        {\n          on: {\n            click: this.disableWrapperClick ? () => {} : this.download\n          }\n        },\n        [\n          this.$scopedSlots.default({\n            download: this.download\n          })\n        ]\n      );\n    }\n    return null;\n  }\n};\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nvar normalizeComponent_1 = normalizeComponent;\n\n/* script */\nconst __vue_script__ = script;\n\n/* template */\n\n  /* style */\n  const __vue_inject_styles__ = undefined;\n  /* scoped */\n  const __vue_scope_id__ = undefined;\n  /* module identifier */\n  const __vue_module_identifier__ = undefined;\n  /* functional template */\n  const __vue_is_functional_template__ = undefined;\n  /* style inject */\n  \n  /* style inject SSR */\n  \n\n  \n  var XlsxDownload = normalizeComponent_1(\n    {},\n    __vue_inject_styles__,\n    __vue_script__,\n    __vue_scope_id__,\n    __vue_is_functional_template__,\n    __vue_module_identifier__,\n    undefined,\n    undefined\n  );\n\nexport default XlsxDownload;\n","<script>\nimport appConfig from '@src/app.config'\nimport Layout from '@layouts/main.vue'\nimport {\n  courseComputed,\n  courseMethods,\n  workbookComputed,\n  workbookMethods,\n} from '@state/helpers'\n// Thanks to: https://vue-xlsx.netlify.app/\nimport { XlsxWorkbook, XlsxSheet, XlsxDownload } from 'vue-xlsx'\nconst XLSX = require('xlsx')\n\nexport default {\n  page: {\n    title: 'Compute Estimates',\n    meta: [{ name: 'description', content: appConfig.description }],\n  },\n  components: {\n    Layout,\n    XlsxWorkbook,\n    XlsxSheet,\n    XlsxDownload,\n  },\n  data() {\n    return {\n      noloThreshold: appConfig.noloThreshold,\n      waitingForFile: true,\n      sheets: [{ name: 'NoLo', data: [[]] }],\n      downloadReady: false,\n      previewHTML: '',\n      previewReady: false,\n      pricesFormatted: false,\n    }\n  },\n  mounted() {\n    if (this.hasWorkbook()) {\n      this.processSheet()\n    } else {\n      this.$router.push({ name: 'get-file' })\n    }\n  },\n  updated() {\n    if (this.pricesFormatted === false) {\n      document.querySelectorAll(\"[id^='sjs-Y']\").forEach((el) => {\n        const v = el.getAttribute('v')\n        if (v === null) {\n          return\n        }\n        const tc = el.textContent\n        if (tc.indexOf('.') === -1) {\n          el.textContent += '.00'\n        } else if (/\\.\\d$/.test(tc)) {\n          el.textContent += '0'\n        }\n      })\n      this.pricesFormatted = true\n    }\n    this.highlightPreview()\n  },\n  methods: {\n    ...courseComputed,\n    ...courseMethods,\n    ...workbookComputed,\n    ...workbookMethods,\n    async processSheet() {\n      this.clearMaterialData()\n      this.downloadReady = false\n      if (this.hasWorkbook) {\n        const sheets = this.workbook().Sheets\n        const firstSheet = sheets[Object.keys(sheets)[0]]\n\n        const COLUMNS = {\n          storeId: 'A',\n          subjectCode: 'E',\n          courseNumber: 'F',\n          sectionId: 'G',\n          note: 'H',\n          adoptionStatus: 'I',\n          materialStatus: 'K', // RQ, CH, etc\n          itemTypeIndicator: 'L',\n          isbn: 'M',\n          author: 'O',\n          title: 'P',\n          eBookType: 'T',\n          eBookFormat: 'U',\n          rental: 'V',\n          newRetailPrice: 'Y',\n          usedRetailPrice: 'Z',\n          instructorLastName: 'AE',\n          instructorFirstName: 'AF',\n          crn: 'AC',\n        }\n\n        let row = 2\n        // the first cell in the row is a row count on the last row, so the second cell is used to check for the end of the data\n        while (typeof firstSheet['B' + row] !== 'undefined') {\n          const rowObj = {}\n          for (const col in COLUMNS) {\n            const cell = COLUMNS[col] + row\n            rowObj[col] =\n              typeof firstSheet[cell] !== 'undefined'\n                ? firstSheet[cell].v.toString().trim()\n                : ''\n          }\n          this.processRow(rowObj)\n          row++\n        }\n        this.sheets[0].data = await this.getAllMaterialCostData()\n        this.sheets[0].data.unshift([\n          'CRN',\n          'Subject Code',\n          'Course Number',\n          'Section Id',\n          'Estimated Cost of Materials',\n          'Notes',\n        ])\n        this.downloadReady = true\n        this.renderPreview()\n      }\n    },\n    renderPreview() {\n      this.previewReady = false\n      this.previewHTML = ''\n      if (this.hasWorkbook) {\n        const sheetNames = this.workbook().SheetNames\n        const sheet1 = sheetNames[0]\n        this.previewHTML = XLSX.utils.sheet_to_html(\n          this.workbook().Sheets[sheet1]\n        )\n        this.previewReady = true\n      }\n    },\n    highlightPreview() {\n      document.querySelectorAll(\"[id^='sjs-Y']\").forEach((el) => {\n        const numericV = parseFloat(el.getAttribute('v'))\n        const tr = el.closest('tr')\n        tr.toggleAttribute(\n          'nolomaybe',\n          isNaN(numericV) || numericV <= this.noloThreshold\n        )\n      })\n    },\n    toggleConcise() {\n      document.getElementById('previewTable').toggleAttribute('concise')\n    },\n  },\n}\n</script>\n\n<template>\n  <Layout>\n    <h1>\n      <BaseIcon name=\"file-excel\" />\n      Compute Estimates</h1\n    >\n    <h2>Preview</h2>\n    <div :class=\"$style.block\">\n      <span>\n        <label for=\"noloThreshold\">Threshold</label>\n        <BaseInputText\n          id=\"noloThreshold\"\n          v-model=\"noloThreshold\"\n          :class=\"[$style.noloThreshold, $style.input]\"\n          type=\"text\"\n          pattern=\"\\d{3}\"\n          @change=\"highlightPreview\"\n        />\n      </span>\n      <span>\n        <XlsxWorkbook>\n          <XlsxSheet\n            v-for=\"sheet in sheets\"\n            :key=\"sheet.name\"\n            :collection=\"sheet.data\"\n            :sheet-name=\"sheet.name\"\n          />\n          <XlsxDownload filename=\"HEOA-ECOM.xlsx\">\n            <BaseButton v-show=\"downloadReady\" type=\"button\"\n              >Download</BaseButton\n            >\n          </XlsxDownload>\n        </XlsxWorkbook>\n      </span>\n    </div>\n\n    <div v-if=\"previewReady\" :class=\"$style.xlsxpreview\">\n      <p\n        >The preview shows <em @click=\"toggleConcise\">all</em> the materials and\n        highlights those less than the threshold. It is intended for a quick\n        check to ensure the spreadsheet data is as expected.\n        <strong :class=\"$style.warning\"\n          >Do not use this for cost estimates.</strong\n        ></p\n      >\n      <table id=\"previewTable\" concise v-html=\"previewHTML\"></table>\n    </div>\n    <div v-else>\n      <p>Please wait ...</p>\n    </div>\n  </Layout>\n</template>\n\n<style lang=\"scss\" module>\n@import '@design';\n\n.block {\n  border-bottom: 1px solid #fff;\n  span {\n    margin: 0 7px;\n    div {\n      display: inline;\n    }\n  }\n  label {\n    padding-right: 10px;\n    font-weight: 600;\n  }\n}\n\n.noloThreshold {\n  display: inline-block;\n  width: 5rem;\n  text-align: right;\n}\n\n.warning {\n  color: #c44d01;\n  background-color: #fff;\n}\n\n.xlsxpreview {\n  width: 90%;\n  margin-top: 25px;\n  table {\n    max-height: 75vh;\n    padding: 25px;\n    overflow: auto;\n    color: #626262;\n    background-color: #fff;\n\n    tbody {\n      tr:nth-child(odd) {\n        background-color: #d4e5f0;\n      }\n\n      tr[nolomaybe] {\n        background-color: #f6dccb;\n      }\n    }\n  }\n  table[concise] tbody tr {\n    td {\n      display: none;\n    }\n    td:nth-child(5),\n    td:nth-child(6),\n    td:nth-child(7),\n    td:nth-child(15),\n    td:nth-child(16),\n    td:nth-child(25) {\n      display: table-cell;\n    }\n    td:nth-child(25) {\n      text-align: right;\n    }\n  }\n  p {\n    line-height: 1.5rem;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./xlsx.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./xlsx.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./xlsx.vue?vue&type=template&id=71decec1&\"\nimport script from \"./xlsx.vue?vue&type=script&lang=js&\"\nexport * from \"./xlsx.vue?vue&type=script&lang=js&\"\nimport style0 from \"./xlsx.vue?vue&type=style&index=0&lang=scss&module=true&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}