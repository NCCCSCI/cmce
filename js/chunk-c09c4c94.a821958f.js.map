{"version":3,"sources":["webpack:///./node_modules/vue-xlsx/dist/polyfills.js","webpack:///./node_modules/core-js/modules/es.string.trim.js","webpack:///./node_modules/core-js/internals/whitespaces.js","webpack:///./node_modules/core-js/internals/string-trim.js","webpack:///./src/router/views/xlsx.vue?aabe","webpack:///./src/router/views/xlsx.vue?361f","webpack:///./node_modules/core-js/internals/string-trim-forced.js","webpack:///./node_modules/core-js/modules/es.symbol.description.js","webpack:///./src/router/views/xlsx.vue?cece","webpack:///./node_modules/vue-xlsx/dist/components/XlsxWorkbook.js","webpack:///./node_modules/vue-xlsx/dist/components/XlsxSheet.js","webpack:///./node_modules/vue-xlsx/dist/components/XlsxDownload.js","webpack:///src/router/views/xlsx.vue","webpack:///./src/router/views/xlsx.vue?ee27","webpack:///./src/router/views/xlsx.vue?794f"],"names":["globalPolyfill","global","window","$","$trim","trim","forcedStringTrimMethod","target","proto","forced","this","module","exports","requireObjectCoercible","whitespaces","whitespace","ltrim","RegExp","rtrim","createMethod","TYPE","$this","string","String","replace","start","end","fails","non","METHOD_NAME","name","DESCRIPTORS","has","isObject","defineProperty","f","copyConstructorProperties","NativeSymbol","Symbol","prototype","undefined","description","EmptyStringDescriptionStore","SymbolWrapper","arguments","length","result","symbolPrototype","constructor","symbolToString","toString","native","regexp","configurable","get","symbol","valueOf","call","desc","slice","render","_vm","_h","$createElement","_c","_self","attrs","_v","class","$style","block","noloThreshold","input","on","highlightPreview","model","value","callback","$$v","expression","_l","sheet","key","data","directives","rawName","xlsxpreview","toggleConcise","warning","domProps","_s","previewHTML","staticRenderFns","WorkbookHandler","libLoaded","loading","getWorkbook","methods","$emit","_callbackQueue","Array","isArray","forEach","cb","_workbook","e","console","push","script","mixins","addSheet","deleteSheet","load","utils","book_new","book_append_sheet","_book_new","_book_append_sheet","sheetName","Sheets","SheetNames","filter","s","h","$slots","default","normalizeComponent","template","style","scopeId","isFunctionalTemplate","moduleIdentifier","shadowMode","createInjector","createInjectorSSR","createInjectorShadow","hook","options","_compiled","functional","_scopeId","context","$vnode","ssrContext","parent","__VUE_SSR_CONTEXT__","_registeredComponents","add","_ssrRegister","$root","$options","shadowRoot","originalRender","existing","beforeCreate","concat","normalizeComponent_1","__vue_script__","__vue_inject_styles__","__vue_scope_id__","__vue_module_identifier__","__vue_is_functional_template__","XlsxWorkbook","typeFinder","Object","collectionValidator","collection","reduce","a","c","inject","props","type","required","includes","computed","watch","readyToParse","immediate","parseCollection","aoa_to_sheet","json_to_sheet","_aoa_to_sheet","_json_to_sheet","wb","lib","array","object","_sheet","XlsxSheet","filename","disableWrapperClick","Boolean","loaded","writeFile","_writeFile","$scopedSlots","click","download","XlsxDownload","page","title","meta","components","Layout","waitingForFile","sheets","downloadReady","previewReady","pricesFormatted","hasWorkbook","processSheet","$router","document","querySelectorAll","v","tc","indexOf","el","textContent","XLSX","sheet_to_html","tr","toggleAttribute","getElementById","injectStyles","locals","component"],"mappings":"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","file":"js/chunk-c09c4c94.a821958f.js","sourcesContent":["export const globalPolyfill = () => {\n  var global = global || window;\n  if (window) {\n    window.global = global;\n  }\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n","// a string of all valid unicode whitespaces\n// eslint-disable-next-line max-len\nmodule.exports = '\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u00A0\\u1680\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","var requireObjectCoercible = require('../internals/require-object-coercible');\nvar whitespaces = require('../internals/whitespaces');\n\nvar whitespace = '[' + whitespaces + ']';\nvar ltrim = RegExp('^' + whitespace + whitespace + '*');\nvar rtrim = RegExp(whitespace + whitespace + '*$');\n\n// `String.prototype.{ trim, trimStart, trimEnd, trimLeft, trimRight }` methods implementation\nvar createMethod = function (TYPE) {\n  return function ($this) {\n    var string = String(requireObjectCoercible($this));\n    if (TYPE & 1) string = string.replace(ltrim, '');\n    if (TYPE & 2) string = string.replace(rtrim, '');\n    return string;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.{ trimLeft, trimStart }` methods\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trimstart\n  start: createMethod(1),\n  // `String.prototype.{ trimRight, trimEnd }` methods\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trimend\n  end: createMethod(2),\n  // `String.prototype.trim` method\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trim\n  trim: createMethod(3)\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"xlsx_block_AjpBa\",\"noloThreshold\":\"xlsx_noloThreshold_CH9Rm\",\"warning\":\"xlsx_warning_2plv8\",\"xlsxpreview\":\"xlsx_xlsxpreview_2dTVG\"};","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-0-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-0-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./xlsx.vue?vue&type=style&index=0&lang=scss&module=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-0-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-0-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-0-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./xlsx.vue?vue&type=style&index=0&lang=scss&module=true&\"","var fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]() || non[METHOD_NAME]() != non || whitespaces[METHOD_NAME].name !== METHOD_NAME;\n  });\n};\n","// `Symbol.prototype.description` getter\n// https://tc39.github.io/ecma262/#sec-symbol.prototype.description\n'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar has = require('../internals/has');\nvar isObject = require('../internals/is-object');\nvar defineProperty = require('../internals/object-define-property').f;\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\n\nvar NativeSymbol = global.Symbol;\n\nif (DESCRIPTORS && typeof NativeSymbol == 'function' && (!('description' in NativeSymbol.prototype) ||\n  // Safari 12 bug\n  NativeSymbol().description !== undefined\n)) {\n  var EmptyStringDescriptionStore = {};\n  // wrap Symbol constructor for correct work with undefined description\n  var SymbolWrapper = function Symbol() {\n    var description = arguments.length < 1 || arguments[0] === undefined ? undefined : String(arguments[0]);\n    var result = this instanceof SymbolWrapper\n      ? new NativeSymbol(description)\n      // in Edge 13, String(Symbol(undefined)) === 'Symbol(undefined)'\n      : description === undefined ? NativeSymbol() : NativeSymbol(description);\n    if (description === '') EmptyStringDescriptionStore[result] = true;\n    return result;\n  };\n  copyConstructorProperties(SymbolWrapper, NativeSymbol);\n  var symbolPrototype = SymbolWrapper.prototype = NativeSymbol.prototype;\n  symbolPrototype.constructor = SymbolWrapper;\n\n  var symbolToString = symbolPrototype.toString;\n  var native = String(NativeSymbol('test')) == 'Symbol(test)';\n  var regexp = /^Symbol\\((.*)\\)[^)]+$/;\n  defineProperty(symbolPrototype, 'description', {\n    configurable: true,\n    get: function description() {\n      var symbol = isObject(this) ? this.valueOf() : this;\n      var string = symbolToString.call(symbol);\n      if (has(EmptyStringDescriptionStore, symbol)) return '';\n      var desc = native ? string.slice(7, -1) : string.replace(regexp, '$1');\n      return desc === '' ? undefined : desc;\n    }\n  });\n\n  $({ global: true, forced: true }, {\n    Symbol: SymbolWrapper\n  });\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Layout',[_c('h1',[_c('BaseIcon',{attrs:{\"name\":\"file-excel\"}}),_vm._v(\" Compute Estimates\")],1),_c('h2',[_vm._v(\"Preview\")]),_c('div',{class:_vm.$style.block},[_c('span',[_c('label',{attrs:{\"for\":\"noloThreshold\"}},[_vm._v(\"Threshold\")]),_c('BaseInputText',{class:[_vm.$style.noloThreshold, _vm.$style.input],attrs:{\"id\":\"noloThreshold\",\"type\":\"text\",\"pattern\":\"\\\\d{3}\"},on:{\"change\":_vm.highlightPreview},model:{value:(_vm.noloThreshold),callback:function ($$v) {_vm.noloThreshold=$$v},expression:\"noloThreshold\"}})],1),_c('span',[_c('XlsxWorkbook',[_vm._l((_vm.sheets),function(sheet){return _c('XlsxSheet',{key:sheet.name,attrs:{\"collection\":sheet.data,\"sheet-name\":sheet.name}})}),_c('XlsxDownload',{attrs:{\"filename\":\"HEOA-ECOM.xlsx\"}},[_c('BaseButton',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.downloadReady),expression:\"downloadReady\"}],attrs:{\"type\":\"button\"}},[_vm._v(\"Download\")])],1)],2)],1)]),(_vm.previewReady)?_c('div',{class:_vm.$style.xlsxpreview},[_c('p',[_vm._v(\"The preview shows \"),_c('em',{on:{\"click\":_vm.toggleConcise}},[_vm._v(\"all\")]),_vm._v(\" the materials and highlights those less than the threshold. It is intended for a quick check to ensure the spreadsheet data is as expected. \"),_c('strong',{class:_vm.$style.warning},[_vm._v(\"Do not use this for cost estimates.\")])]),_c('table',{attrs:{\"id\":\"previewTable\",\"concise\":\"\"},domProps:{\"innerHTML\":_vm._s(_vm.previewHTML)}})]):_c('div',[_c('p',[_vm._v(\"Please wait ...\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var WorkbookHandler = {\n  data() {\n    return {\n      libLoaded: false,\n      loading: false\n    };\n  },\n  provide() {\n    return {\n      getWorkbook: this.getWorkbook\n    };\n  },\n  methods: {\n    startLoading() {\n      this.loading = true;\n      this.$emit(\"loading\", this.loading);\n    },\n    endLoading() {\n      this.loading = false;\n      this.$emit(\"loading\", this.loading);\n    },\n    fireCallBacks() {\n      if (this._callbackQueue && Array.isArray(this._callbackQueue)) {\n        this._callbackQueue.forEach(cb => {\n          try {\n            cb(this._workbook);\n          } catch (e) {\n            console.warning(\"error in firing callbacks\", e);\n          }\n        });\n      }\n    },\n    getWorkbook(cb) {\n      if (this._callbackQueue) {\n        this._callbackQueue.push(cb);\n      }\n      if (this._workbook) {\n        cb(this._workbook);\n      }\n    }\n  }\n};\n\nvar script = {\n  mixins: [WorkbookHandler],\n  provide() {\n    return {\n      addSheet: this.addSheet,\n      deleteSheet: this.deleteSheet\n    };\n  },\n  mounted() {\n    this.load();\n  },\n  methods: {\n    async load() {\n      const { globalPolyfill } = require(\"../polyfills\");\n      globalPolyfill();\n      const {\n        utils: { book_new, book_append_sheet }\n      } = await import('xlsx');\n      this._book_new = book_new;\n      this._book_append_sheet = book_append_sheet;\n      this._workbook = this._book_new();\n      this.$emit(\"created\", this._workbook);\n      this.libLoaded = true;\n    },\n    addSheet(sheet, sheetName) {\n      if (this._workbook) {\n        this.deleteSheet(sheetName);\n        this._book_append_sheet(this._workbook, sheet, sheetName);\n        this.$emit(\"change\", this._workbook);\n      }\n    },\n    deleteSheet(sheetName) {\n      if (this._workbook && this._workbook.Sheets[sheetName]) {\n        this._workbook.SheetNames = this._workbook.SheetNames.filter(\n          s => s !== sheetName\n        );\n        this._workbook.Sheets[sheetName] = undefined;\n        this.$emit(\"change\", this._workbook);\n      }\n    }\n  },\n  render(h) {\n    if (this.$slots.default && this.libLoaded) {\n      return h(\"div\", this.$slots.default);\n    }\n    return null;\n  }\n};\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nvar normalizeComponent_1 = normalizeComponent;\n\n/* script */\nconst __vue_script__ = script;\n\n/* template */\n\n  /* style */\n  const __vue_inject_styles__ = undefined;\n  /* scoped */\n  const __vue_scope_id__ = undefined;\n  /* module identifier */\n  const __vue_module_identifier__ = undefined;\n  /* functional template */\n  const __vue_is_functional_template__ = undefined;\n  /* style inject */\n  \n  /* style inject SSR */\n  \n\n  \n  var XlsxWorkbook = normalizeComponent_1(\n    {},\n    __vue_inject_styles__,\n    __vue_script__,\n    __vue_scope_id__,\n    __vue_is_functional_template__,\n    __vue_module_identifier__,\n    undefined,\n    undefined\n  );\n\nexport default XlsxWorkbook;\n","const typeFinder = value =>\n  value instanceof Array ? \"array\" : value instanceof Object ? \"object\" : false;\n\nconst collectionValidator = collection => {\n  return collection.reduce((a, c) => {\n    if (a === null) {\n      return typeFinder(c);\n    } else {\n      return typeFinder(c) === a ? a : false;\n    }\n  }, null);\n};\n\nvar script = {\n  inject: [\"getWorkbook\", \"addSheet\", \"deleteSheet\"],\n  props: {\n    sheetName: {\n      type: String,\n      required: true\n    },\n    collection: {\n      type: Array,\n      default: null,\n      validator(value) {\n        if (value && value.length > 0) {\n          const type = collectionValidator(value);\n          return [\"array\", \"object\"].includes(type);\n        }\n        return true;\n      }\n    }\n  },\n  data() {\n    return {\n      libLoaded: false\n    };\n  },\n  computed: {\n    readyToParse() {\n      return this.libLoaded ? this.collection : null;\n    }\n  },\n  watch: {\n    readyToParse: {\n      immediate: true,\n      handler(collection) {\n        if (collection) {\n          this.parseCollection(collection);\n        }\n      }\n    }\n  },\n  mounted() {\n    this.load();\n  },\n  beforeDestroy() {\n    this.deleteSheet(this.sheetName);\n  },\n  methods: {\n    async load() {\n      const {\n        utils: { aoa_to_sheet, json_to_sheet }\n      } = await import('xlsx');\n      this._aoa_to_sheet = aoa_to_sheet;\n      this._json_to_sheet = json_to_sheet;\n      this.libLoaded = true;\n      this.getWorkbook(wb => {\n        this._workbook = wb;\n      });\n    },\n    parseCollection(collection) {\n      const type = typeFinder(collection[0]);\n      const lib = {\n        array: this._aoa_to_sheet,\n        object: this._json_to_sheet\n      };\n      this._sheet = lib[type](collection, this.options);\n      this.$emit(\"parsed\", this._sheet);\n      this.addSheet(this._sheet, this.sheetName);\n    }\n  },\n  render(h) {\n    if (this.$slots.default && this.libLoaded) {\n      return h(\"div\", this.$slots.default);\n    }\n    return null;\n  }\n};\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nvar normalizeComponent_1 = normalizeComponent;\n\n/* script */\nconst __vue_script__ = script;\n\n/* template */\n\n  /* style */\n  const __vue_inject_styles__ = undefined;\n  /* scoped */\n  const __vue_scope_id__ = undefined;\n  /* module identifier */\n  const __vue_module_identifier__ = undefined;\n  /* functional template */\n  const __vue_is_functional_template__ = undefined;\n  /* style inject */\n  \n  /* style inject SSR */\n  \n\n  \n  var XlsxSheet = normalizeComponent_1(\n    {},\n    __vue_inject_styles__,\n    __vue_script__,\n    __vue_scope_id__,\n    __vue_is_functional_template__,\n    __vue_module_identifier__,\n    undefined,\n    undefined\n  );\n\nexport default XlsxSheet;\n","var script = {\n  inject: [\"getWorkbook\"],\n  props: {\n    filename: {\n      type: String,\n      default: \"my-workbook.xlsx\"\n    },\n    options: {\n      type: Object,\n      default: () => ({})\n    },\n    disableWrapperClick: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      loaded: false\n    };\n  },\n  mounted() {\n    this.load();\n  },\n  watch: {\n    loaded: {\n      immediate: true,\n      handler(loaded) {\n        if (loaded) {\n          this.getWorkbook(wb => {\n            this._workbook = wb;\n          });\n        }\n      }\n    }\n  },\n  methods: {\n    async load() {\n      const { writeFile } = await import('xlsx');\n      this._writeFile = writeFile;\n      this.loaded = true;\n    },\n    download() {\n      this._writeFile(this._workbook, this.filename, this.options);\n    }\n  },\n  render(h) {\n    if (this.$scopedSlots.default && this.loaded) {\n      return h(\n        \"div\",\n        {\n          on: {\n            click: this.disableWrapperClick ? () => {} : this.download\n          }\n        },\n        [\n          this.$scopedSlots.default({\n            download: this.download\n          })\n        ]\n      );\n    }\n    return null;\n  }\n};\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nvar normalizeComponent_1 = normalizeComponent;\n\n/* script */\nconst __vue_script__ = script;\n\n/* template */\n\n  /* style */\n  const __vue_inject_styles__ = undefined;\n  /* scoped */\n  const __vue_scope_id__ = undefined;\n  /* module identifier */\n  const __vue_module_identifier__ = undefined;\n  /* functional template */\n  const __vue_is_functional_template__ = undefined;\n  /* style inject */\n  \n  /* style inject SSR */\n  \n\n  \n  var XlsxDownload = normalizeComponent_1(\n    {},\n    __vue_inject_styles__,\n    __vue_script__,\n    __vue_scope_id__,\n    __vue_is_functional_template__,\n    __vue_module_identifier__,\n    undefined,\n    undefined\n  );\n\nexport default XlsxDownload;\n","<script>\nimport appConfig from '@src/app.config'\nimport Layout from '@layouts/main.vue'\nimport {\n  courseComputed,\n  courseMethods,\n  workbookComputed,\n  workbookMethods,\n} from '@state/helpers'\n// Thanks to: https://vue-xlsx.netlify.app/\nimport { XlsxWorkbook, XlsxSheet, XlsxDownload } from 'vue-xlsx'\nconst XLSX = require('xlsx')\n\nexport default {\n  page: {\n    title: 'Compute Estimates',\n    meta: [{ name: 'description', content: appConfig.description }],\n  },\n  components: {\n    Layout,\n    XlsxWorkbook,\n    XlsxSheet,\n    XlsxDownload,\n  },\n  data() {\n    return {\n      noloThreshold: appConfig.noloThreshold,\n      waitingForFile: true,\n      sheets: [{ name: 'NoLo', data: [[]] }],\n      downloadReady: false,\n      previewHTML: '',\n      previewReady: false,\n      pricesFormatted: false,\n    }\n  },\n  mounted() {\n    if (this.hasWorkbook()) {\n      this.processSheet()\n    } else {\n      this.$router.push({ name: 'get-file' })\n    }\n  },\n  updated() {\n    if (this.pricesFormatted === false) {\n      document.querySelectorAll(\"[id^='sjs-Y']\").forEach((el) => {\n        const v = el.getAttribute('v')\n        if (v === null) {\n          return\n        }\n        const tc = el.textContent\n        if (tc.indexOf('.') === -1) {\n          el.textContent += '.00'\n        } else if (/\\.\\d$/.test(tc)) {\n          el.textContent += '0'\n        }\n      })\n      this.pricesFormatted = true\n    }\n    this.highlightPreview()\n  },\n  methods: {\n    ...courseComputed,\n    ...courseMethods,\n    ...workbookComputed,\n    ...workbookMethods,\n    async processSheet() {\n      this.clearMaterialData()\n      this.downloadReady = false\n      if (this.hasWorkbook) {\n        const sheets = this.workbook().Sheets\n        const firstSheet = sheets[Object.keys(sheets)[0]]\n\n        const COLUMNS = {\n          storeId: 'A',\n          subjectCode: 'E',\n          courseNumber: 'F',\n          sectionId: 'G',\n          note: 'H',\n          adoptionStatus: 'I',\n          materialStatus: 'K', // RQ, CH, etc\n          itemTypeIndicator: 'L',\n          isbn: 'M',\n          author: 'O',\n          title: 'P',\n          eBookType: 'T',\n          eBookFormat: 'U',\n          rental: 'V',\n          newRetailPrice: 'Y',\n          usedRetailPrice: 'Z',\n          instructorLastName: 'AE',\n          instructorFirstName: 'AF',\n          crn: 'AC',\n        }\n\n        let row = 2\n        // the first cell in the row is a row count on the last row, so the second cell is used to check for the end of the data\n        while (typeof firstSheet['B' + row] !== 'undefined') {\n          const rowObj = {}\n          for (const col in COLUMNS) {\n            const cell = COLUMNS[col] + row\n            rowObj[col] =\n              typeof firstSheet[cell] !== 'undefined'\n                ? firstSheet[cell].v.toString().trim()\n                : ''\n          }\n          this.processRow(rowObj)\n          row++\n        }\n        this.sheets[0].data = await this.getAllMaterialCostData()\n        this.sheets[0].data.unshift([\n          'CRN',\n          'Subject Code',\n          'Course Number',\n          'Section Id',\n          'Estimated Cost of Materials',\n          'Notes',\n        ])\n        this.downloadReady = true\n        this.renderPreview()\n      }\n    },\n    renderPreview() {\n      this.previewReady = false\n      this.previewHTML = ''\n      if (this.hasWorkbook) {\n        const sheetNames = this.workbook().SheetNames\n        const sheet1 = sheetNames[0]\n        this.previewHTML = XLSX.utils.sheet_to_html(\n          this.workbook().Sheets[sheet1]\n        )\n        this.previewReady = true\n      }\n    },\n    highlightPreview() {\n      document.querySelectorAll(\"[id^='sjs-Y']\").forEach((el) => {\n        const numericV = parseFloat(el.getAttribute('v'))\n        const tr = el.closest('tr')\n        tr.toggleAttribute(\n          'nolomaybe',\n          isNaN(numericV) || numericV <= this.noloThreshold\n        )\n      })\n    },\n    toggleConcise() {\n      document.getElementById('previewTable').toggleAttribute('concise')\n    },\n  },\n}\n</script>\n\n<template>\n  <Layout>\n    <h1>\n      <BaseIcon name=\"file-excel\" />\n      Compute Estimates</h1\n    >\n    <h2>Preview</h2>\n    <div :class=\"$style.block\">\n      <span>\n        <label for=\"noloThreshold\">Threshold</label>\n        <BaseInputText\n          id=\"noloThreshold\"\n          v-model=\"noloThreshold\"\n          :class=\"[$style.noloThreshold, $style.input]\"\n          type=\"text\"\n          pattern=\"\\d{3}\"\n          @change=\"highlightPreview\"\n        />\n      </span>\n      <span>\n        <XlsxWorkbook>\n          <XlsxSheet\n            v-for=\"sheet in sheets\"\n            :key=\"sheet.name\"\n            :collection=\"sheet.data\"\n            :sheet-name=\"sheet.name\"\n          />\n          <XlsxDownload filename=\"HEOA-ECOM.xlsx\">\n            <BaseButton v-show=\"downloadReady\" type=\"button\"\n              >Download</BaseButton\n            >\n          </XlsxDownload>\n        </XlsxWorkbook>\n      </span>\n    </div>\n\n    <div v-if=\"previewReady\" :class=\"$style.xlsxpreview\">\n      <p\n        >The preview shows <em @click=\"toggleConcise\">all</em> the materials and\n        highlights those less than the threshold. It is intended for a quick\n        check to ensure the spreadsheet data is as expected.\n        <strong :class=\"$style.warning\"\n          >Do not use this for cost estimates.</strong\n        ></p\n      >\n      <table id=\"previewTable\" concise v-html=\"previewHTML\"></table>\n    </div>\n    <div v-else>\n      <p>Please wait ...</p>\n    </div>\n  </Layout>\n</template>\n\n<style lang=\"scss\" module>\n@import '@design';\n\n.block {\n  border-bottom: 1px solid #fff;\n  span {\n    margin: 0 7px;\n    div {\n      display: inline;\n    }\n  }\n  label {\n    padding-right: 10px;\n    font-weight: 600;\n  }\n}\n\n.noloThreshold {\n  display: inline-block;\n  width: 5rem;\n  text-align: right;\n}\n\n.warning {\n  color: #c44d01;\n  background-color: #fff;\n}\n\n.xlsxpreview {\n  width: 90%;\n  margin-top: 25px;\n  table {\n    max-height: 75vh;\n    padding: 25px;\n    overflow: auto;\n    color: #626262;\n    background-color: #fff;\n\n    tbody {\n      tr:nth-child(odd) {\n        background-color: #d4e5f0;\n      }\n\n      tr[nolomaybe] {\n        background-color: #f6dccb;\n      }\n    }\n  }\n  table[concise] tbody tr {\n    td {\n      display: none;\n    }\n    td:nth-child(5),\n    td:nth-child(6),\n    td:nth-child(7),\n    td:nth-child(15),\n    td:nth-child(16),\n    td:nth-child(25) {\n      display: table-cell;\n    }\n    td:nth-child(25) {\n      text-align: right;\n    }\n  }\n  p {\n    line-height: 1.5rem;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./xlsx.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./xlsx.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./xlsx.vue?vue&type=template&id=71decec1&\"\nimport script from \"./xlsx.vue?vue&type=script&lang=js&\"\nexport * from \"./xlsx.vue?vue&type=script&lang=js&\"\nimport style0 from \"./xlsx.vue?vue&type=style&index=0&lang=scss&module=true&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}