(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08f14b58"],{"40bd":function(e,t,o){"use strict";o.r(t),o.d(t,"globalPolyfill",(function(){return s}));const s=()=>{var e=e||window;window&&(window.global=e)}},"498a":function(e,t,o){"use strict";var s=o("23e7"),i=o("58a8").trim,n=o("c8d2");s({target:"String",proto:!0,forced:n("trim")},{trim:function(){return i(this)}})},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,o){var s=o("1d80"),i=o("5899"),n="["+i+"]",r=RegExp("^"+n+n+"*"),a=RegExp(n+n+"*$"),d=function(e){return function(t){var o=String(s(t));return 1&e&&(o=o.replace(r,"")),2&e&&(o=o.replace(a,"")),o}};e.exports={start:d(1),end:d(2),trim:d(3)}},a1db:function(e,t,o){e.exports={block:"xlsx_block_AjpBa",noloThreshold:"xlsx_noloThreshold_CH9Rm",warning:"xlsx_warning_2plv8",xlsxpreview:"xlsx_xlsxpreview_2dTVG"}},a2a4:function(e,t,o){"use strict";var s=o("a1db"),i=o.n(s);t["default"]=i.a},c8d2:function(e,t,o){var s=o("d039"),i=o("5899"),n="​᠎";e.exports=function(e){return s((function(){return!!i[e]()||n[e]()!=n||i[e].name!==e}))}},ec06:function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("Layout",[o("h1",[o("BaseIcon",{attrs:{name:"file-excel"}}),e._v(" Compute Estimates")],1),o("h2",[e._v("Preview")]),o("div",{class:e.$style.block},[o("span",[o("label",{attrs:{for:"noloThreshold"}},[e._v("Threshold")]),o("BaseInputText",{class:[e.$style.noloThreshold,e.$style.input],attrs:{id:"noloThreshold",type:"text",pattern:"\\d{3}"},on:{change:e.highlightPreview},model:{value:e.noloThreshold,callback:function(t){e.noloThreshold=t},expression:"noloThreshold"}})],1),o("span",[o("XlsxWorkbook",[e._l(e.sheets,(function(e){return o("XlsxSheet",{key:e.name,attrs:{collection:e.data,"sheet-name":e.name}})})),o("XlsxDownload",{attrs:{filename:"HEOA-ECOM.xlsx"}},[o("BaseButton",{directives:[{name:"show",rawName:"v-show",value:e.downloadReady,expression:"downloadReady"}],attrs:{type:"button"}},[e._v("Download")])],1)],2)],1)]),e.previewReady?o("div",{class:e.$style.xlsxpreview},[o("p",[e._v("The preview shows "),o("em",{on:{click:e.toggleConcise}},[e._v("all")]),e._v(" the materials and highlights those less than the threshold. It is intended for a quick check to ensure the spreadsheet data is as expected. "),o("strong",{class:e.$style.warning},[e._v("Do not use this for cost estimates.")])]),o("table",{attrs:{id:"previewTable",concise:""},domProps:{innerHTML:e._s(e.previewHTML)}})]):o("div",[o("p",[e._v("Please wait ...")])])])},i=[],n=o("1da1"),r=o("5530"),a=(o("96cf"),o("a4d3"),o("e01a"),o("159b"),o("b64b"),o("498a"),o("d3b7"),o("25f0"),o("c2a4")),d=o("444f"),l=o("4d77"),h={data(){return{libLoaded:!1,loading:!1}},provide(){return{getWorkbook:this.getWorkbook}},methods:{startLoading(){this.loading=!0,this.$emit("loading",this.loading)},endLoading(){this.loading=!1,this.$emit("loading",this.loading)},fireCallBacks(){this._callbackQueue&&Array.isArray(this._callbackQueue)&&this._callbackQueue.forEach(e=>{try{e(this._workbook)}catch(t){console.warning("error in firing callbacks",t)}})},getWorkbook(e){this._callbackQueue&&this._callbackQueue.push(e),this._workbook&&e(this._workbook)}}},c={mixins:[h],provide(){return{addSheet:this.addSheet,deleteSheet:this.deleteSheet}},mounted(){this.load()},methods:{async load(){const{globalPolyfill:e}=o("40bd");e();const{utils:{book_new:t,book_append_sheet:s}}=await Promise.resolve().then(o.t.bind(null,"1146",7));this._book_new=t,this._book_append_sheet=s,this._workbook=this._book_new(),this.$emit("created",this._workbook),this.libLoaded=!0},addSheet(e,t){this._workbook&&(this.deleteSheet(t),this._book_append_sheet(this._workbook,e,t),this.$emit("change",this._workbook))},deleteSheet(e){this._workbook&&this._workbook.Sheets[e]&&(this._workbook.SheetNames=this._workbook.SheetNames.filter(t=>t!==e),this._workbook.Sheets[e]=void 0,this.$emit("change",this._workbook))}},render(e){return this.$slots.default&&this.libLoaded?e("div",this.$slots.default):null}};function u(e,t,o,s,i,n,r,a,d,l){"boolean"!==typeof r&&(d=a,a=r,r=!1);var h,c="function"===typeof o?o.options:o;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),s&&(c._scopeId=s),n?(h=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,d(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},c._ssrRegister=h):t&&(h=r?function(){t.call(this,l(this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),h)if(c.functional){var u=c.render;c.render=function(e,t){return h.call(t),u(e,t)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}return o}var p=u;const f=c,_=void 0,b=void 0,v=void 0,k=void 0;var w=p({},_,f,b,k,v,void 0,void 0),m=w;const g=e=>e instanceof Array?"array":e instanceof Object&&"object",y=e=>e.reduce((e,t)=>null===e?g(t):g(t)===e&&e,null);var x={inject:["getWorkbook","addSheet","deleteSheet"],props:{sheetName:{type:String,required:!0},collection:{type:Array,default:null,validator(e){if(e&&e.length>0){const t=y(e);return["array","object"].includes(t)}return!0}}},data(){return{libLoaded:!1}},computed:{readyToParse(){return this.libLoaded?this.collection:null}},watch:{readyToParse:{immediate:!0,handler(e){e&&this.parseCollection(e)}}},mounted(){this.load()},beforeDestroy(){this.deleteSheet(this.sheetName)},methods:{async load(){const{utils:{aoa_to_sheet:e,json_to_sheet:t}}=await Promise.resolve().then(o.t.bind(null,"1146",7));this._aoa_to_sheet=e,this._json_to_sheet=t,this.libLoaded=!0,this.getWorkbook(e=>{this._workbook=e})},parseCollection(e){const t=g(e[0]),o={array:this._aoa_to_sheet,object:this._json_to_sheet};this._sheet=o[t](e,this.options),this.$emit("parsed",this._sheet),this.addSheet(this._sheet,this.sheetName)}},render(e){return this.$slots.default&&this.libLoaded?e("div",this.$slots.default):null}};function S(e,t,o,s,i,n,r,a,d,l){"boolean"!==typeof r&&(d=a,a=r,r=!1);var h,c="function"===typeof o?o.options:o;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),s&&(c._scopeId=s),n?(h=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,d(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},c._ssrRegister=h):t&&(h=r?function(){t.call(this,l(this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),h)if(c.functional){var u=c.render;c.render=function(e,t){return h.call(t),u(e,t)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}return o}var C=S;const $=x,T=void 0,R=void 0,E=void 0,j=void 0;var N=C({},T,$,R,j,E,void 0,void 0),O=N,F={inject:["getWorkbook"],props:{filename:{type:String,default:"my-workbook.xlsx"},options:{type:Object,default:()=>({})},disableWrapperClick:{type:Boolean,default:!1}},data(){return{loaded:!1}},mounted(){this.load()},watch:{loaded:{immediate:!0,handler(e){e&&this.getWorkbook(e=>{this._workbook=e})}}},methods:{async load(){const{writeFile:e}=await Promise.resolve().then(o.t.bind(null,"1146",7));this._writeFile=e,this.loaded=!0},download(){this._writeFile(this._workbook,this.filename,this.options)}},render(e){return this.$scopedSlots.default&&this.loaded?e("div",{on:{click:this.disableWrapperClick?()=>{}:this.download}},[this.$scopedSlots.default({download:this.download})]):null}};function L(e,t,o,s,i,n,r,a,d,l){"boolean"!==typeof r&&(d=a,a=r,r=!1);var h,c="function"===typeof o?o.options:o;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),s&&(c._scopeId=s),n?(h=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,d(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},c._ssrRegister=h):t&&(h=r?function(){t.call(this,l(this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),h)if(c.functional){var u=c.render;c.render=function(e,t){return h.call(t),u(e,t)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}return o}var P=L;const A=F,W=void 0,I=void 0,X=void 0,B=void 0;var M=P({},W,A,I,B,X,void 0,void 0),H=M,V=o("1146"),D={page:{title:"Compute Estimates",meta:[{name:"description",content:a.description}]},components:{Layout:d["a"],XlsxWorkbook:m,XlsxSheet:O,XlsxDownload:H},data:function(){return{noloThreshold:a.noloThreshold,waitingForFile:!0,sheets:[{name:"NoLo",data:[[]]}],downloadReady:!1,previewHTML:"",previewReady:!1,pricesFormatted:!1}},mounted:function(){this.hasWorkbook()?this.processSheet():this.$router.push({name:"get-file"})},updated:function(){!1===this.pricesFormatted&&(document.querySelectorAll("[id^='sjs-Y']").forEach((function(e){var t=e.getAttribute("v");if(null!==t){var o=e.textContent;-1===o.indexOf(".")?e.textContent+=".00":/\.\d$/.test(o)&&(e.textContent+="0")}})),this.pricesFormatted=!0),this.highlightPreview()},methods:Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])({},l["a"]),l["b"]),l["e"]),l["f"]),{},{processSheet:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var o,s,i,n,r,a,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.clearMaterialData(),e.downloadReady=!1,!e.hasWorkbook){t.next=14;break}o=e.workbook().Sheets,s=o[Object.keys(o)[0]],i={storeId:"A",subjectCode:"E",courseNumber:"F",sectionId:"G",note:"H",adoptionStatus:"I",materialStatus:"K",itemTypeIndicator:"L",isbn:"M",author:"O",title:"P",eBookType:"T",eBookFormat:"U",rental:"V",newRetailPrice:"Y",usedRetailPrice:"Z",instructorLastName:"AE",instructorFirstName:"AF",crn:"AC"},n=2;while("undefined"!==typeof s["B"+n]){for(a in r={},i)d=i[a]+n,r[a]="undefined"!==typeof s[d]?s[d].v.toString().trim():"";e.processRow(r),n++}return t.next=10,e.getAllMaterialCostData();case 10:e.sheets[0].data=t.sent,e.sheets[0].data.unshift(["CRN","Subject Code","Course Number","Section Id","Estimated Cost of Materials","Notes"]),e.downloadReady=!0,e.renderPreview();case 14:case"end":return t.stop()}}),t)})))()},renderPreview:function(){if(this.previewReady=!1,this.previewHTML="",this.hasWorkbook){var e=this.workbook().SheetNames,t=e[0];this.previewHTML=V.utils.sheet_to_html(this.workbook().Sheets[t]),this.previewReady=!0}},highlightPreview:function(){var e=this;document.querySelectorAll("[id^='sjs-Y']").forEach((function(t){var o=parseFloat(t.getAttribute("v")),s=t.closest("tr");s.toggleAttribute("nolomaybe",isNaN(o)||o<=e.noloThreshold)}))},toggleConcise:function(){document.getElementById("previewTable").toggleAttribute("concise")}})},U=D,Q=o("a2a4"),q=o("2877");function Y(e){this["$style"]=Q["default"].locals||Q["default"]}var G=Object(q["a"])(U,s,i,!1,Y,null,null);t["default"]=G.exports}}]);
//# sourceMappingURL=chunk-08f14b58-legacy.1ba2ceaf.js.map